System.register(["./history-legacy-D--lc3Kv.js","./summary-legacy-Bgc9NEes.js","./banks-legacy-BKIrSNgF.js"],function(t,e){"use strict";var n,s,i,r,o,a,c;return{setters:[t=>{n=t.e,s=t.g,i=t.f,r=t.q,o=t.E},null,t=>{a=t.b,c=t.f}],execute:function(){var t=document.createElement("style");function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}t.textContent='.header{display:flex;align-items:center;justify-content:space-between;padding:15px 20px;background:#2c3e50;color:#fff;box-shadow:0 2px 4px rgba(0,0,0,.1)}.progress{flex:1;height:12px;background:#34495e;margin:0 20px;border-radius:6px;overflow:hidden}.progress .bar{height:100%;background:#3498db;width:0%;transition:width .3s ease}.timer-display{display:flex;flex-direction:column;align-items:center;padding:8px 16px;background:rgba(255,255,255,.1);border-radius:8px;border:1px solid rgba(255,255,255,.2);min-width:120px;margin-right:16px}.timer-label{font-size:11px;color:rgba(255,255,255,.8);text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px;font-weight:500}.timer-value{font-size:18px;font-weight:700;color:#fff;font-family:Courier New,monospace;letter-spacing:1px}.timer-display.warning{background:rgba(255,152,0,.2);border-color:rgba(255,152,0,.4)}.timer-display.critical{background:rgba(244,67,54,.2);border-color:rgba(244,67,54,.4)}.timer-warning{font-family:Nunito,sans-serif;animation:slideInRight .3s ease-out}@keyframes slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.container{max-width:1024px;margin:0 auto}.header-right .btn:hover{transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.2)}.main{display:flex;height:calc(100vh - 120px);background:#fff}.sidebar{width:110px;background-color:#f8f9fa;border-right:1px solid #e9ecef;padding:20px 10px 20px 25px;box-sizing:border-box;height:100%;overflow-y:auto;overflow-x:hidden;box-shadow:2px 0 4px rgba(0,0,0,.05)}.sidebar::-webkit-scrollbar{width:6px}.sidebar::-webkit-scrollbar-track{background:#f8f9fa}.sidebar::-webkit-scrollbar-thumb{background:#bdc3c7;border-radius:3px}.sidebar::-webkit-scrollbar-thumb:hover{background:#95a5a6}.nav{list-style:none;padding:0;margin:0}.nav li{display:flex;align-items:center;justify-content:center;width:50px;height:30px;border-radius:5px;border:none;background-color:#49698d;color:#fff;font-weight:700;font-size:13px;cursor:pointer;position:relative;box-sizing:border-box;transition:all .2s ease;font-family:Nunito,Arial,sans-serif;margin:3px 0;padding:0}.nav li.active{background:#49698d;color:#fff;position:relative}.nav li.active:after{content:"";position:absolute;right:-10px;top:50%;transform:translateY(-50%);width:0;height:0;border-left:12px solid;border-top:15px solid transparent;border-bottom:15px solid transparent;z-index:10;border-left-color:#49698d}.nav li.active.answered:after{border-left-color:#394552}.nav li.flagged{position:relative}.nav li.answered{position:relative;background-color:#394552}.nav li.answered:before{content:"";position:absolute;top:0;left:0;width:8px;height:8px;background:#ecf0f1;border-radius:0 0 8px;box-shadow:1px 1px 2px rgba(0,0,0,.1);z-index:2}.nav li.flagged .flag-btn{color:#fff;display:inline}.flag-btn{display:none;position:absolute;top:2px;right:2px;background:none;border:none;padding:0;cursor:pointer;font-size:14px;line-height:1}.question-area{flex:1;padding:30px;background:#fff;overflow-y:auto;overflow-x:hidden;box-shadow:inset 2px 0 4px rgba(0,0,0,.05)}.question-area::-webkit-scrollbar{width:8px}.question-area::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.question-area::-webkit-scrollbar-thumb{background:#bdc3c7;border-radius:4px}.question-area::-webkit-scrollbar-thumb:hover{background:#95a5a6}.q-number{font-size:20pt;font-weight:700;margin:0 0 25px;color:#2c3e50;line-height:1.2}.dose-table{width:100%;border-collapse:collapse;margin-top:10px}.dose-table th,.dose-table td{border:1px solid #bdc3c7;padding:8px;text-align:left}.dose-table th{background-color:#ecf0f1;color:#2c3e50;font-weight:600}.footer{position:fixed;bottom:0;left:50%;transform:translate(-50%);max-width:1024px;width:100%;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:10px 20px;background:#2c3e50}.footer-left{display:flex;align-items:center}.review-status-btn{background:#27ae60;color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;display:flex;align-items:center;gap:8px;transition:all .2s ease;box-shadow:0 2px 4px rgba(0,0,0,.2)}.review-status-btn:hover{background:#219a52;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.3)}.review-icon{font-size:16px}.review-text{font-size:14px}.review-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;backdrop-filter:blur(2px);padding:20px}.review-modal .modal-content{background:#fff;border-radius:12px;width:100%;max-width:600px;max-height:85vh;overflow-y:auto;box-shadow:0 8px 24px rgba(0,0,0,.3);margin:auto}.review-modal .modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e9ecef;background:#f8f9fa;border-radius:12px 12px 0 0}.review-modal .modal-header h3{margin:0;color:#2c3e50;font-size:18px}.review-modal .modal-close{background:none;border:none;font-size:24px;cursor:pointer;color:#6c757d;padding:0;width:30px;height:30px;display:flex;align-items:center;justify-content:center}.review-modal .modal-close:hover{color:#343a40}.review-modal .modal-body{padding:20px}.filter-section{display:flex;align-items:center;gap:20px;margin-bottom:20px;padding:15px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.filter-title{font-weight:600;color:#495057;font-size:14px}.filter-options{display:flex;gap:20px}.filter-option{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:14px;color:#495057}.filter-option input[type=checkbox]{width:16px;height:16px;border:2px solid #6c757d;border-radius:3px;cursor:pointer}.filter-option input[type=checkbox]:checked{background:#495057;border-color:#495057}.clear-filter-btn{background:#346888;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.clear-filter-btn:hover{background:#2c5a78;transform:translateY(-1px)}.question-grid-review{display:flex;flex-wrap:wrap;gap:6px;margin-top:20px;max-width:100%;justify-content:flex-start}.question-grid-review .grid-item{width:50px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:5px;border:none;background-color:#49698d;color:#fff;font-weight:700;font-size:13px;cursor:pointer;position:relative;box-sizing:border-box;transition:all .2s ease;font-family:Nunito,Arial,sans-serif;margin:0;padding:0}.question-grid-review .grid-item.attempted{background:#394552;color:#fff}.question-grid-review .grid-item.not-attempted{background:#49698d;color:#fff}.question-grid-review .grid-item.current{background:#49698d;color:#fff;border-color:#3498db;box-shadow:0 0 0 2px #3498db}.question-grid-review .grid-item.answered{background:#394552;color:#fff}.question-grid-review .grid-item.active{background:#49698d;color:#fff;border-color:#3498db;box-shadow:0 0 0 2px #3498db}.question-grid-review .grid-item.flagged .flag-btn{color:#fff;display:inline}.question-grid-review .grid-item.flagged{position:relative}.question-grid-review .grid-item.flagged:after{content:""}.question-grid-review .grid-item:hover{transform:scale(1.1)}.nav-btns{width:100%;display:flex;justify-content:flex-end;align-items:center;gap:15px}.nav-btns button{margin:0;padding:8px 16px;border-radius:8px;border:none;cursor:pointer;font-size:16px;min-width:80px;height:40px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:all .2s ease;font-family:Nunito,Arial,sans-serif;font-weight:600;white-space:nowrap}.back-btn{background:#346888;color:#bdc3c7}.back-btn:hover:not(:disabled){background:#2c5a78;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.3)}.back-btn:disabled{background:#34495e;cursor:not-allowed;opacity:.7}.next-btn{background:#346888;color:#fff}.next-btn:hover{background:#2c5a78;transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.3)}.next-btn:disabled{background:#34495e;cursor:not-allowed;opacity:.7}.footer .nav-btns .flag-current-btn{background:#346888;color:#fff;font-size:20px!important;transition:all .2s ease;min-width:50px}.footer .nav-btns .flag-current-btn:hover{background:#2c5a78;transform:translateY(-1px) scale(1.05);box-shadow:0 4px 8px rgba(0,0,0,.3)}.footer .nav-btns .flag-current-btn.flagged{background:#e74c3c;color:#fff}.footer .nav-btns .flag-current-btn.flagged:hover{background:#c0392b;transform:translateY(-1px) scale(1.05);box-shadow:0 4px 8px rgba(0,0,0,.3)}.summary{padding:25px;background:#fff;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,.1)}.summary h2{color:#2c3e50;margin-bottom:10px;font-size:24px}.summary-score{margin-bottom:20px;text-align:center}.score-display{font-size:32px;font-weight:700;color:#2c3e50;margin-right:10px}.percentage-display{font-size:20px;color:#7f8c8d;font-weight:600}.button-row{margin-top:20px;display:flex;gap:15px}.header-right{display:flex;align-items:center;gap:10px}.pdf-pane{flex:0 0 40%;max-width:40%;display:none;flex-direction:column;height:100%;background:#fff;border-right:1px solid #ccc}.pdf-controls{padding:5px;background:#e5e9f0;border-bottom:1px solid #ccc}.pdf-controls button{margin-right:5px;padding:4px 8px}.pdf-wrapper{flex:1;overflow:auto}.pdf-btn{margin-top:10px}#pdfFrame{width:100%;height:100%;border:none;transform-origin:top left}.enhanced-summary-stats{margin:20px 0;padding:20px;background:#f8fafc;border-radius:12px;border:1px solid #e2e8f0}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:16px;margin-top:16px}.stat-item{text-align:center;padding:12px;border-radius:8px;background:#fff;border:1px solid #e2e8f0;transition:all .2s ease}.stat-item:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.stat-value{display:block;font-size:18px;font-weight:700;margin-bottom:4px}.stat-label{display:block;font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:.5px}.stat-item.correct .stat-value{color:#059669}.stat-item.wrong .stat-value{color:#dc2626}.stat-item.not-answered .stat-value{color:#d97706}.stat-item.time-used .stat-value{color:#3b82f6}.stat-item.time-allocated .stat-value{color:#6b7280}.stat-item.time-saved .stat-value{color:#059669}.summary{padding:40px;background:#fff;min-height:100vh;text-align:center}.summary-header h2{font-size:32px;color:#2c3e50;margin:0 0 20px}.score-display{font-size:48px;font-weight:700;color:#3498db;margin-bottom:40px}.summary-stats{display:flex;justify-content:center;gap:40px;margin-bottom:50px}.stat{text-align:center;padding:20px;border-radius:12px;min-width:120px}.stat.correct{background:#d4edda;border:2px solid #28a745}.stat.incorrect{background:#f8d7da;border:2px solid #dc3545}.stat.unanswered{background:#e2e3e5;border:2px solid #6c757d}.stat .number{display:block;font-size:36px;font-weight:700;margin-bottom:8px}.stat.correct .number{color:#28a745}.stat.incorrect .number{color:#dc3545}.stat.unanswered .number{color:#6c757d}.stat .label{display:block;font-size:14px;font-weight:600;text-transform:uppercase;letter-spacing:1px}.summary-actions{display:flex;justify-content:center;gap:20px;flex-wrap:wrap}.summary-actions button{padding:15px 30px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease;min-width:150px}#reviewAllBtn{background:#3498db;color:#fff}#reviewAllBtn:hover{background:#2980b9;transform:translateY(-2px)}#reviewIncorrectBtn{background:#e74c3c;color:#fff}#reviewIncorrectBtn:hover{background:#c0392b;transform:translateY(-2px)}#goHomeBtn{background:#2c3e50;color:#fff}#goHomeBtn:hover{background:#1a252f;transform:translateY(-2px)}\n/*$vite$:1*/',document.head.appendChild(t);var l,d={exports:{}},u=(l||(l=1,function(t,e){!function(t){function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function n(t){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?e(Object(s),!0).forEach(function(e){i(t,e,s[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))})}return t}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function i(t,e,n){return(e=o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,e);if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=r(t,"string");return"symbol"==typeof e?e:String(e)}function a(t,e,n){var s,i="";if((t="number"==typeof t?String(t):t).length>e)return t;for(s=0;s<e;s+=1)i+=String(n);return(i+t).slice(-i.length)}function c(){this.reset()}function l(){this.events={}}c.prototype.toString=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["hours","minutes","seconds"],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;t=t||["hours","minutes","seconds"],e=e||":",n=n||2;var s,i=[];for(s=0;s<t.length;s+=1)void 0!==this[t[s]]&&("secondTenths"===t[s]?i.push(this[t[s]]):i.push(a(this[t[s]],n,"0")));return i.join(e)},c.prototype.reset=function(){this.secondTenths=0,this.seconds=0,this.minutes=0,this.hours=0,this.days=0},l.prototype.on=function(t,e){var n=this;return Array.isArray(this.events[t])||(this.events[t]=[]),this.events[t].push(e),function(){return n.removeListener(t,e)}},l.prototype.removeListener=function(t,e){if(Array.isArray(this.events[t])){var n=this.events[t].indexOf(e);n>-1&&this.events[t].splice(n,1)}},l.prototype.removeAllListeners=function(t){t?Array.isArray(this.events[t])&&(this.events[t]=[]):this.events={}},l.prototype.emit=function(t){for(var e=this,n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];Array.isArray(this.events[t])&&this.events[t].forEach(function(t){return t.apply(e,s)})};var d=10,u=60,h=60,p=24,g=0,f=1,m=2,b=3,x=4,w="secondTenths",y="seconds",v="minutes",k="hours",S="days",T=[w,y,v,k,S],E={secondTenths:100,seconds:1e3,minutes:6e4,hours:36e5,days:864e5},Q={secondTenths:d,seconds:u,minutes:h,hours:p};function C(t,e){return(t%e+e)%e}function q(){var t,e,i,r,o,a,q,L,I,A,z=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},j=new c,O=new c,D=new l,R=!1,B=!1,M={},N={detail:{timer:this}};function P(t,e){var n=Q[t];O[t]=e,j[t]=t===S?Math.abs(e):C(e>=0?e:n-C(e,n),n)}function F(t){return Y(t,S)}function U(t){return Y(t,k)}function $(t){return Y(t,v)}function H(t){return Y(t,y)}function V(t){return Y(t,w)}function Y(t,e){var n=O[e];return P(e,ct(t,E[e])),O[e]!==n}function W(){_(),st()}function _(){clearInterval(t),t=void 0,R=!1,B=!1}function K(t){vt()?(I=J(),a=lt(o.target)):it(t),G()}function G(){var n=E[e];nt(tt(Date.now()))||(t=setInterval(X,n),R=!0,B=!1)}function J(){return tt(Date.now())-O.secondTenths*E[w]*i}function X(){var t=tt(Date.now());et(Z()),r(N.detail.timer),nt(t)&&(ht(),wt("targetAchieved",N))}function Z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt(Date.now()),e=i>0?t-I:I-t,n={};return n[w]=V(e),n[y]=H(e),n[v]=$(e),n[k]=U(e),n[S]=F(e),n}function tt(t){return Math.floor(t/E[e])*E[e]}function et(t){t[w]&&wt("secondTenthsUpdated",N),t[y]&&wt("secondsUpdated",N),t[v]&&wt("minutesUpdated",N),t[k]&&wt("hoursUpdated",N),t[S]&&wt("daysUpdated",N)}function nt(t){return a instanceof Array&&t>=A}function st(){j.reset(),O.reset()}function it(t){e=rt((t=t||{}).precision),r="function"==typeof t.callback?t.callback:function(){},L=!0===t.countdown,i=!0===L?-1:1,"object"===s(t.startValues)?dt(t.startValues):q=null,I=J(),Z(),"object"===s(t.target)?a=lt(t.target):L?(t.target={seconds:0},a=lt(t.target)):a=null,M={precision:e,callback:r,countdown:"object"===s(t)&&!0===t.countdown,target:a,startValues:q},o=t}function rt(t){if(!ot(t="string"==typeof t?t:y))throw new Error("Error in precision parameter: ".concat(t," is not a valid value"));return t}function ot(t){return T.indexOf(t)>=0}function at(t){var e;if("object"===s(t))if(t instanceof Array){if(5!==t.length)throw new Error("Array size not valid");e=t}else{for(var n in t)if(T.indexOf(n)<0)throw new Error("Error in startValues or target parameter: ".concat(n," is not a valid input value"));e=[t.secondTenths||0,t.seconds||0,t.minutes||0,t.hours||0,t.days||0]}e=e.map(function(t){return parseInt(t,10)});var i=e[g],r=e[f]+ct(i,d),o=e[m]+ct(r,u),a=e[b]+ct(o,h),c=e[x]+ct(a,p);return e[g]=i%d,e[f]=r%u,e[m]=o%h,e[b]=a%p,e[x]=c,e}function ct(t,e){var n=t/e;return n<0?Math.ceil(n):Math.floor(n)}function lt(t){if(t){var e=ut(a=at(t));return A=I+e.secondTenths*E[w]*i,a}}function dt(t){q=at(t),j.secondTenths=q[g],j.seconds=q[f],j.minutes=q[m],j.hours=q[b],j.days=q[x],O=ut(q,O)}function ut(t,e){var n=e||{};return n.days=t[x],n.hours=n.days*p+t[b],n.minutes=n.hours*h+t[m],n.seconds=n.minutes*u+t[f],n.secondTenths=n.seconds*d+t[[g]],n}function ht(){W(),wt("stopped",N)}function pt(){W(),K(o),wt("reset",N)}function gt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=n(n({},z),t),yt()||(K(t),wt("started",N))}function ft(){_(),B=!0,wt("paused",N)}function mt(t,e){D.on(t,e)}function bt(t,e){D.removeListener(t,e)}function xt(t){D.removeAllListeners(t)}function wt(t,e){D.emit(t,e)}function yt(){return R}function vt(){return B}function kt(){return j}function St(){return O}function Tt(){return M}it(z),void 0!==this&&(this.start=gt,this.pause=ft,this.stop=ht,this.reset=pt,this.isRunning=yt,this.isPaused=vt,this.getTimeValues=kt,this.getTotalTimeValues=St,this.getConfig=Tt,this.addEventListener=mt,this.on=mt,this.removeEventListener=bt,this.removeAllEventListeners=xt,this.off=bt)}t.Timer=q,t.default=q,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,d.exports)),d.exports);const h=e(u);class p{timer;totalSeconds;callbacks;warningsShown=new Set;constructor(t,e={}){this.timer=new h,this.totalSeconds=Math.max(60,3*t*60),this.callbacks=e,this.setupEventListeners(),this.setupTimerHealthCheck()}healthCheckInterval=null;setupEventListeners(){this.timer.addEventListener("secondsUpdated",()=>{const t=this.timer.getTimeValues(),e=this.timer.getTotalTimeValues().seconds;this.callbacks.onUpdate&&this.callbacks.onUpdate(t),this.checkWarnings(e)}),this.timer.addEventListener("targetAchieved",()=>{this.callbacks.onComplete&&this.callbacks.onComplete()})}checkWarnings(t){const e=300;t!==e||this.warningsShown.has(e)||(this.warningsShown.add(e),this.callbacks.onWarning&&this.callbacks.onWarning({timeLeft:e,message:"⚠️ 5 minutes remaining"})),60!==t||this.warningsShown.has(60)||(this.warningsShown.add(60),this.callbacks.onWarning&&this.callbacks.onWarning({timeLeft:60,message:"⚠️ 1 minute remaining"}))}start(){this.startWithTime(this.totalSeconds)}startWithTime(t){try{this.timer.start({countdown:!0,startValues:{seconds:t}})}catch(e){console.error("Failed to start timer:",e),setTimeout(()=>{try{this.timer.start({countdown:!0,startValues:{seconds:t}})}catch(e){console.error("Timer restart failed:",e)}},100)}}setupTimerHealthCheck(){this.healthCheckInterval=window.setInterval(()=>{if(this.timer.isRunning()){const t=this.getTotalRemainingSeconds();t<=0&&(console.warn("Timer health check: Timer expired, triggering completion"),this.clearHealthCheck(),this.callbacks.onComplete&&this.callbacks.onComplete()),this.checkTimerStall(t)}},3e4)}lastHealthCheckTime=0;healthCheckStallCount=0;checkTimerStall(t){this.lastHealthCheckTime===t?(this.healthCheckStallCount++,this.healthCheckStallCount>=3&&(console.warn("Timer appears stalled, attempting restart"),this.healthCheckStallCount=0,this.timer.isRunning()&&(this.timer.stop(),this.timer.start({countdown:!0,startValues:{seconds:t}})))):this.healthCheckStallCount=0,this.lastHealthCheckTime=t}clearHealthCheck(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}pause(){this.timer.pause()}resume(){this.timer.isPaused()&&this.timer.start()}stop(){this.timer.stop()}reset(){this.timer.reset(),this.warningsShown.clear()}getRemainingTime(){return this.timer.getTimeValues()}getTotalRemainingSeconds(){return this.timer.getTotalTimeValues().seconds}getFormattedTime(){const t=this.timer.getTimeValues(),e=t.hours.toString().padStart(2,"0"),n=t.minutes.toString().padStart(2,"0"),s=t.seconds.toString().padStart(2,"0");return t.hours>0?`${e}:${n}:${s}`:`${n}:${s}`}isRunning(){return this.timer.isRunning()}isPaused(){return this.timer.isPaused()}destroy(){this.clearHealthCheck(),this.timer.removeAllEventListeners(),this.timer.stop()}static formatSeconds(t){const e=Math.floor(t/3600),n=Math.floor(t%3600/60),s=t%60;return e>0?`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${n.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}static calculateTestDuration(t){return 3*t*60}}window.evaluateAnswer=n,window.getCorrectAnswerText=s,window.formatExplanation=i,(new class{state=null;isFinished=!1;sessionKey="";timer=null;timerDisplayElement=null;timeUpTriggered=!1;constructor(){this.timerDisplayElement=document.getElementById("timerValue")}init(){const t=new URLSearchParams(window.location.search),e=t.get("bank"),n=parseInt(t.get("num")||"10"),s="true"===t.get("resume");if(!e||!a||!a[e])return alert("No valid question bank selected"),void(window.location.href="index.html");this.sessionKey=`practice_session_${e}_${n}`,s||this.loadExistingSession()?console.log("Resuming existing practice session"):this.setupPracticeSession(e,n),this.setupEventListeners(),this.renderCurrentQuestion(),window.addEventListener("beforeunload",()=>{this.saveSession(),this.timer&&this.timer.destroy()})}setupPracticeSession(t,e){const n=a[t];if(!n||!n.length)return void alert("Question bank is empty");(e<=0||e>100)&&(alert("Invalid number of questions. Using default of 10."),e=10);const s=[];n.forEach(t=>{s.push(...t)});const i=s.sort(()=>Math.random()-.5),r=i.slice(0,Math.min(e,i.length));this.state={currentQuestion:0,questions:r,answers:{},flagged:new Set,startTime:Date.now(),bank:t,totalQuestions:r.length};const o=document.querySelector(".test-title");o&&(o.textContent=`${c(t)} - ${r.length} Questions`),this.setupNavigation(),this.updateProgress(),this.initializeTimer()}setupNavigation(){if(!this.state)return;const t=document.querySelector(".sidebar .nav");if(t){t.innerHTML="";for(let e=0;e<this.state.totalQuestions;e++){const n=document.createElement("li");n.dataset.question=e.toString(),n.textContent=(e+1).toString(),t.appendChild(n)}t.addEventListener("click",t=>{const e=t.target.closest("li");if(e&&e.dataset.question){const t=parseInt(e.dataset.question);this.goToQuestion(t)}})}}setupEventListeners(){const t=document.querySelector(".back-btn"),e=document.querySelector(".next-btn"),n=document.querySelector(".flag-current-btn"),s=document.querySelector(".finish-btn"),i=document.getElementById("checkBtn");t&&t.addEventListener("click",()=>this.previousQuestion()),e&&e.addEventListener("click",()=>this.nextQuestion()),n&&n.addEventListener("click",()=>this.toggleFlag()),s&&s.addEventListener("click",()=>this.finishTest()),i&&i.addEventListener("click",()=>this.toggleCheck()),document.addEventListener("change",t=>{const e=t.target;"answer"!==e.name&&"calcInput"!==e.id||this.saveAnswer()});const r=document.querySelector(".review-status-btn");r&&r.addEventListener("click",()=>this.showReviewModal());const o=document.querySelector(".modal-close");o&&o.addEventListener("click",()=>this.hideReviewModal())}renderCurrentQuestion(){if(!this.state||this.state.currentQuestion>=this.state.questions.length)return;const t=this.state.questions[this.state.currentQuestion],e=document.querySelector(".q-number");e&&(e.textContent=`Question ${this.state.currentQuestion+1}`),r&&r.renderQuestion(t,{text:"#qText",title:"#qTitle",img:"#qImg",options:"#answerOptions",input:".calculator",unit:"#answerUnit",feedback:"#feedback",answer:"#answer",explanation:"#explanation"});const n=this.state.answers[this.state.currentQuestion];if(n)if(t.is_calculation){const t=document.getElementById("calcInput");t&&(t.value=n)}else{const t=document.querySelector(`input[name="answer"][value="${n}"]`);if(t){t.checked=!0;const e=t.closest("label");e&&e.classList.add("selected")}}const s=document.getElementById("questionFlag");s&&(this.state.flagged.has(this.state.currentQuestion)?s.style.display="inline":s.style.display="none"),this.resetFeedbackAndButtons(),this.updateNavigation(),this.updateProgress(),this.saveSession()}saveAnswer(){if(!this.state)return;let t="";if(this.state.questions[this.state.currentQuestion].is_calculation){const e=document.getElementById("calcInput");t=e?.value||""}else{const e=document.querySelector('input[name="answer"]:checked');t=e?.value||""}if(t?(this.state.answers[this.state.currentQuestion]=t,this.updateNavigation(),this.updateProgress(),this.saveSession()):(delete this.state.answers[this.state.currentQuestion],this.updateNavigation(),this.updateProgress(),this.saveSession()),r&&"hidden"!==r.getCurrentDisplayState()){const t=this.state.questions[this.state.currentQuestion];r.displayAnswer(t,"hide")}}updateProgress(){if(!this.state)return;const t=document.querySelector(".progress .bar"),e=Object.keys(this.state.answers).length/this.state.totalQuestions*100;t&&(t.style.width=`${e}%`)}updateNavigation(){if(!this.state)return;const t=document.querySelector(".back-btn"),e=document.querySelector(".next-btn"),n=document.querySelector(".flag-current-btn");t&&(t.disabled=0===this.state.currentQuestion),e&&(e.disabled=this.state.currentQuestion===this.state.totalQuestions-1),n&&n.classList.toggle("active",this.state.flagged.has(this.state.currentQuestion)),document.querySelectorAll(".sidebar .nav li").forEach((t,e)=>{const n=t;n.classList.remove("active","answered","flagged");const s=e+1;this.state.flagged.has(e)?(n.innerHTML=`${s} <span class="flag-btn">⚑</span>`,n.classList.add("flagged")):n.textContent=s.toString(),e===this.state.currentQuestion&&n.classList.add("active"),this.state.answers[e]&&n.classList.add("answered")})}goToQuestion(t){!this.state||t<0||t>=this.state.totalQuestions||(this.state.currentQuestion=t,this.renderCurrentQuestion())}previousQuestion(){!this.state||this.state.currentQuestion<=0||this.goToQuestion(this.state.currentQuestion-1)}nextQuestion(){!this.state||this.state.currentQuestion>=this.state.totalQuestions-1||this.goToQuestion(this.state.currentQuestion+1)}toggleFlag(){if(!this.state)return;const t=this.state.currentQuestion,e=document.getElementById("questionFlag");this.state.flagged.has(t)?(this.state.flagged.delete(t),e&&(e.style.display="none")):(this.state.flagged.add(t),e&&(e.style.display="inline")),this.updateNavigation(),this.saveSession()}toggleCheck(){if(!this.state||!r)return;const t=this.state.questions[this.state.currentQuestion],e=this.state.answers[this.state.currentQuestion];"checked"===r.getCurrentDisplayState()?r.displayAnswer(t,"hide"):r.displayAnswer(t,"check",e)}resetFeedbackAndButtons(){r&&r.displayAnswer({id:0},"hide")}finishTest(){if(!this.state)return;const t=Object.keys(this.state.answers).length,e=this.state.totalQuestions-t;e>0&&!window.confirm(`You have ${e} unanswered questions. Are you sure you want to finish the test?`)||(this.calculateResults(),this.clearSession(),this.showSummary())}initializeTimer(t){if(this.state){if(this.timer&&(this.timer.destroy(),this.timer=null),this.timer=new p(this.state.totalQuestions,{onUpdate:()=>this.updateTimerDisplay(),onWarning:t=>this.handleTimerWarning(t),onComplete:()=>this.handleTimeUp()}),void 0!==t&&t>0){const e=3*this.state.totalQuestions*60-t;this.state.startTime=Date.now()-1e3*e,this.timer.startWithTime(t)}else this.timer.start();this.checkTimerExpiry()}}checkTimerExpiry(){this.state&&this.timer&&Date.now()-this.state.startTime>=3*this.state.totalQuestions*60*1e3&&(console.warn("Timer failsafe triggered - test time has expired"),this.handleTimeUp())}updateTimerDisplay(){if(this.timerDisplayElement&&this.timer)try{const t=this.timer.getFormattedTime();this.timerDisplayElement.textContent=t;const e=this.timer.getTotalRemainingSeconds(),n=document.getElementById("timerDisplay");if(e<0)return console.warn("Timer display failsafe: Negative time detected, triggering completion"),void this.handleTimeUp();n&&(n.classList.remove("warning","critical"),e<=60?n.classList.add("critical"):e<=300&&n.classList.add("warning"))}catch(t){console.error("Error updating timer display:",t),this.timerDisplayElement&&(this.timerDisplayElement.textContent="00:00")}}handleTimerWarning(t){!function(t){const e=document.createElement("div");e.className="timer-warning",e.textContent=t.message,e.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #ff9800;\n    color: white;\n    padding: 12px 20px;\n    border-radius: 6px;\n    font-weight: 600;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    z-index: 1000;\n    animation: slideInRight 0.3s ease-out;\n  ";const n=document.createElement("style");n.textContent="\n    @keyframes slideInRight {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n    @keyframes fadeOut {\n      from {\n        opacity: 1;\n      }\n      to {\n        opacity: 0;\n      }\n    }\n  ",document.head.appendChild(n),document.body.appendChild(e),setTimeout(()=>{e.style.animation="fadeOut 0.3s ease-out",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)},5e3)}(t)}handleTimeUp(){if(!this.state||this.timeUpTriggered)return;this.timeUpTriggered=!0,this.isFinished=!0,this.timer&&(this.timer.destroy(),this.timer=null);const t=this.createTimeUpModal();document.body.appendChild(t)}createTimeUpModal(){const t=document.createElement("div");t.className="time-up-modal",t.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      font-family: 'Nunito', sans-serif;\n    ";const e=document.createElement("div");e.style.cssText="\n      background: white;\n      padding: 40px;\n      border-radius: 12px;\n      text-align: center;\n      max-width: 400px;\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n    ";const n=document.createElement("h2");n.textContent="⏰ Time's Up!",n.style.cssText="\n      color: #e74c3c;\n      margin: 0 0 20px 0;\n      font-size: 28px;\n    ";const s=document.createElement("p");s.textContent="Your practice test time has expired. You can still review your answers or finish the test now.",s.style.cssText="\n      color: #555;\n      margin: 0 0 30px 0;\n      line-height: 1.5;\n      font-size: 16px;\n    ";const i=document.createElement("div");i.style.cssText="\n      display: flex;\n      gap: 15px;\n      justify-content: center;\n    ";const r=document.createElement("button");r.textContent="Finish Test",r.className="btn btn-danger",r.style.cssText="\n      padding: 12px 24px;\n      font-weight: 600;\n      border: none;\n      border-radius: 6px;\n      cursor: pointer;\n      background: #e74c3c;\n      color: white;\n    ",r.addEventListener("click",()=>{document.body.removeChild(t),this.finishTest()});const o=document.createElement("button");return o.textContent="Continue Review",o.className="btn btn-secondary",o.style.cssText="\n      padding: 12px 24px;\n      font-weight: 600;\n      border: 1px solid #ccc;\n      border-radius: 6px;\n      cursor: pointer;\n      background: white;\n      color: #555;\n    ",o.addEventListener("click",()=>{document.body.removeChild(t)}),i.appendChild(r),i.appendChild(o),e.appendChild(n),e.appendChild(s),e.appendChild(i),t.appendChild(e),t}calculateResults(){if(!this.state)return;let t=0;const e=Math.floor((Date.now()-this.state.startTime)/6e4);for(let r=0;r<this.state.questions.length;r++){const e=this.state.questions[r],s=this.state.answers[r];s&&n(e,s)&&t++}const s=Math.round(t/this.state.totalQuestions*100),i=Date.now().toString();this.savePracticeResult({id:i,bank:this.state.bank,totalQuestions:this.state.totalQuestions,correctAnswers:t,score:s,duration:e,date:(new Date).toISOString(),flaggedQuestions:this.state.flagged.size,questions:this.state.questions,answers:this.state.answers,flagged:Array.from(this.state.flagged)}),this.isFinished=!0,window.location.href=`summary.html?resultId=${i}`}showSummary(){}showReviewModal(){if(!this.state)return;const t=document.getElementById("reviewModal");t&&(this.setupFilterHandlers(),this.updateQuestionGrid(),t.style.display="block")}setupFilterHandlers(){const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),n=document.getElementById("filterFlagged"),s=document.querySelector(".clear-filter-btn");t&&t.addEventListener("change",()=>this.updateQuestionGrid()),e&&e.addEventListener("change",()=>this.updateQuestionGrid()),n&&n.addEventListener("change",()=>this.updateQuestionGrid()),s&&s.addEventListener("click",()=>this.clearFilters())}clearFilters(){const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),n=document.getElementById("filterFlagged");t&&(t.checked=!1),e&&(e.checked=!1),n&&(n.checked=!1),this.updateQuestionGrid()}updateQuestionGrid(){if(!this.state)return;const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),n=document.getElementById("filterFlagged"),s=document.getElementById("questionGridReview");if(s){s.innerHTML="";for(let i=0;i<this.state.totalQuestions;i++){const r=!!this.state.answers[i],o=this.state.flagged.has(i),a=i===this.state.currentQuestion;let c=!1;if(t?.checked||e?.checked||n?.checked?(r&&e?.checked&&(c=!0),!r&&t?.checked&&(c=!0),o&&n?.checked&&(c=!0)):c=!0,!c)continue;const l=document.createElement("button");l.className="grid-item",l.dataset.question=i.toString();const d=i+1;o?(l.innerHTML=`${d} <span class="flag-btn">⚑</span>`,l.classList.add("flagged")):l.textContent=d.toString(),r&&l.classList.add("answered"),a&&l.classList.add("active"),l.addEventListener("click",()=>{this.goToQuestion(i),this.hideReviewModal()}),s.appendChild(l)}}}hideReviewModal(){const t=document.getElementById("reviewModal");t&&(t.style.display="none")}savePracticeResult(t){try{const e=localStorage.getItem("practice_history"),n=e?JSON.parse(e):{...o};n.results.unshift(t),n.results.length>50&&(n.results=n.results.slice(0,50)),localStorage.setItem("practice_history",JSON.stringify(n))}catch(e){console.warn("Failed to save practice result:",e)}}saveSession(){if(this.state&&!this.isFinished)try{let t=0;if(this.timer&&this.timer.isRunning())t=this.timer.getTotalRemainingSeconds();else{const e=Date.now()-this.state.startTime,n=3*this.state.totalQuestions*60*1e3;t=Math.max(0,Math.floor((n-e)/1e3))}const e={currentQuestion:this.state.currentQuestion,answers:this.state.answers,flagged:Array.from(this.state.flagged),startTime:this.state.startTime,bank:this.state.bank,totalQuestions:this.state.totalQuestions,questions:this.state.questions.map(t=>t.id),timestamp:Date.now(),remainingSeconds:t,timerActive:!this.timer||this.timer.isRunning()};sessionStorage.setItem(this.sessionKey,JSON.stringify(e)),console.log("Session saved:",this.sessionKey)}catch(t){console.warn("Failed to save session:",t)}}loadExistingSession(){try{const t=sessionStorage.getItem(this.sessionKey);if(!t)return!1;const e=JSON.parse(t);if(Date.now()-e.timestamp>864e5)return sessionStorage.removeItem(this.sessionKey),!1;const n=a[e.bank],s=[];n.forEach(t=>{s.push(...t)});const i=e.questions.map(t=>s.find(e=>e.id===t)).filter(t=>void 0!==t);if(i.length!==e.totalQuestions)return console.warn("Question mismatch, starting new session"),!1;this.state={currentQuestion:e.currentQuestion,questions:i,answers:e.answers||{},flagged:new Set(e.flagged||[]),startTime:e.startTime,bank:e.bank,totalQuestions:e.totalQuestions};const r=document.querySelector(".test-title");r&&(r.textContent=`${c(e.bank)} - ${i.length} Questions`),this.setupNavigation();const o=e.remainingSeconds;return!1!==e.timerActive&&o>0?this.initializeTimer(o):o<=0?this.handleTimeUp():this.initializeTimer(),console.log("Session loaded successfully"),!0}catch(t){return console.warn("Failed to load session:",t),!1}}clearSession(){try{sessionStorage.removeItem(this.sessionKey),console.log("Session cleared:",this.sessionKey)}catch(t){console.warn("Failed to clear session:",t)}this.timer&&(this.timer.destroy(),this.timer=null)}}).init()}}});
//# sourceMappingURL=practice-legacy-ClPrJxPW.js.map
