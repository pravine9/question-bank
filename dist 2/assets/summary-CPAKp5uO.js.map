{"version":3,"file":"summary-CPAKp5uO.js","sources":["../../static/summary.ts","../../templates/summary.html?html-proxy&index=0.js"],"sourcesContent":["// Summary Page Logic - Dedicated Implementation\n\nimport type { PracticeResult } from '@/types/question';\nimport { EMPTY_HISTORY } from '@/utils/history';\nimport { evaluateAnswer, getCorrectAnswerText, formatExplanation } from '@/utils/answers';\nimport { questionRenderer } from './question_renderer';\n\n// Make utility functions globally available for questionRenderer\n(window as any).evaluateAnswer = evaluateAnswer;\n(window as any).getCorrectAnswerText = getCorrectAnswerText;\n(window as any).formatExplanation = formatExplanation;\n\nexport class SummaryManager {\n  private testResult: PracticeResult | null = null;\n  private currentReviewQuestion: number = 0;\n  private reviewMode: 'all' | 'incorrect' | 'flagged' = 'all';\n  private filteredRows: HTMLTableRowElement[] = [];\n\n  constructor() {\n    this.init();\n    this.setupBackButtonHandling();\n  }\n\n  init(): void {\n    this.loadTestResult();\n    this.setupEventListeners();\n  }\n\n  private loadTestResult(): void {\n    const params = new URLSearchParams(window.location.search);\n    const resultId = params.get('resultId');\n    \n    if (!resultId) {\n      alert('No test result found');\n      window.location.href = 'index.html';\n      return;\n    }\n\n    try {\n      const existingHistory = localStorage.getItem('practice_history');\n      const history = existingHistory ? JSON.parse(existingHistory) : { ...EMPTY_HISTORY };\n      \n      const result = history.results.find((r: any) => r.id === resultId);\n      if (!result) {\n        alert('Test result not found');\n        window.location.href = 'index.html';\n        return;\n      }\n\n      this.testResult = result;\n      this.populateSummary();\n    } catch (error) {\n      console.error('Failed to load test result:', error);\n      alert('Failed to load test result');\n      window.location.href = 'index.html';\n    }\n  }\n\n  private populateSummary(): void {\n    if (!this.testResult) return;\n\n    const tbody = document.querySelector('.summary-table tbody') as HTMLTableSectionElement;\n    const scoreText = document.getElementById('scoreText') as HTMLElement;\n\n    if (!tbody) return;\n\n    let correctCount = 0;\n    tbody.innerHTML = '';\n    this.filteredRows = [];\n\n    for (let i = 0; i < this.testResult.questions.length; i++) {\n      const question = this.testResult.questions[i];\n      const userAnswer = this.testResult.answers[i] || 'No answer';\n      const isCorrect =\n        userAnswer !== 'No answer' && evaluateAnswer(question, userAnswer);\n      \n      if (isCorrect) {\n        correctCount++;\n      }\n\n      const row = tbody.insertRow();\n      this.filteredRows.push(row);\n      \n      const statusClass = isCorrect ? 'correct' : 'incorrect';\n      const statusText = isCorrect ? '✓ Correct' : '✗ Incorrect';\n      \n      // Get the actual answer text instead of just the number\n      let userAnswerText = userAnswer;\n      if (userAnswer !== 'No answer' && !question.is_calculation) {\n        const selectedAnswer = question.answers.find(a => a.answer_number.toString() === userAnswer);\n        userAnswerText = selectedAnswer ? selectedAnswer.text : userAnswer;\n      }\n      \n      row.innerHTML = `\n        <td>\n          <div class=\"question-number\">${i + 1}</div>\n        </td>\n        <td class=\"answer-cell\">${userAnswerText}</td>\n        <td class=\"correct-answer-cell\">${getCorrectAnswerText(question)}</td>\n        <td class=\"status-cell ${statusClass}\">${statusText}</td>\n        <td class=\"review-cell\">\n          <button class=\"review-question\" data-question=\"${i}\">Review</button>\n        </td>\n      `;\n    }\n\n    const score = Math.round((correctCount / this.testResult.totalQuestions) * 100);\n\n    // Update score display\n    if (scoreText) scoreText.textContent = `You scored ${correctCount}/${this.testResult.totalQuestions} (${score}%)`;\n\n    // Add review handlers\n    tbody.addEventListener('click', (e) => {\n      const btn = (e.target as HTMLElement).closest('.review-question') as HTMLButtonElement;\n      if (btn) {\n        const questionNum = parseInt(btn.dataset.question || '0');\n        this.openReviewModal(questionNum);\n      }\n    });\n\n    // Apply initial filter (show all questions by default)\n    this.applyFilters();\n  }\n\n  private setupEventListeners(): void {\n    const goHomeBtn = document.getElementById('goHomeBtn');\n    const modalClose = document.querySelector('.modal-close');\n    const closeReviewBtn = document.getElementById('closeReviewBtn');\n    const prevQuestionBtn = document.getElementById('prevQuestionBtn');\n    const nextQuestionBtn = document.getElementById('nextQuestionBtn');\n    const clearFilterBtn = document.querySelector('.clear-filter-btn');\n    if (goHomeBtn) {\n      goHomeBtn.addEventListener('click', () => {\n        window.location.href = 'index.html';\n      });\n    }\n    if (modalClose) {\n      modalClose.addEventListener('click', () => this.closeReviewModal());\n    }\n    if (closeReviewBtn) {\n      closeReviewBtn.addEventListener('click', () => this.closeReviewModal());\n    }\n    if (prevQuestionBtn) {\n      prevQuestionBtn.addEventListener('click', () => this.navigateReviewQuestion(-1));\n    }\n    if (nextQuestionBtn) {\n      nextQuestionBtn.addEventListener('click', () => this.navigateReviewQuestion(1));\n    }\n    if (clearFilterBtn) {\n      clearFilterBtn.addEventListener('click', () => this.clearFilters());\n    }\n\n    // Filter event listeners\n    const filterCorrect = document.getElementById('filterCorrect') as HTMLInputElement;\n    const filterIncorrect = document.getElementById('filterIncorrect') as HTMLInputElement;\n    const filterUnanswered = document.getElementById('filterUnanswered') as HTMLInputElement;\n\n    if (filterCorrect) {\n      filterCorrect.addEventListener('change', () => this.applyFilters());\n    }\n    if (filterIncorrect) {\n      filterIncorrect.addEventListener('change', () => this.applyFilters());\n    }\n    if (filterUnanswered) {\n      filterUnanswered.addEventListener('change', () => this.applyFilters());\n    }\n\n    // Close modal on outside click\n    const modal = document.getElementById('reviewModal');\n    if (modal) {\n      modal.addEventListener('click', (e) => {\n        if (e.target === modal) {\n          this.closeReviewModal();\n        }\n      });\n    }\n  }\n\n  private applyFilters(): void {\n    const filterCorrect = document.getElementById('filterCorrect') as HTMLInputElement;\n    const filterIncorrect = document.getElementById('filterIncorrect') as HTMLInputElement;\n    const filterUnanswered = document.getElementById('filterUnanswered') as HTMLInputElement;\n\n    if (!this.testResult) return;\n\n    // If no filters are selected, show all questions\n    const hasActiveFilters = (filterCorrect?.checked || filterIncorrect?.checked || filterUnanswered?.checked);\n\n    this.filteredRows.forEach((row, index) => {\n      const question = this.testResult!.questions[index];\n      const userAnswer = this.testResult!.answers[index] || 'No answer';\n      const isCorrect = userAnswer !== 'No answer' && evaluateAnswer(question, userAnswer);\n      \n      let shouldShow = false;\n      \n      if (!hasActiveFilters) {\n        // If no filters are selected, show all questions\n        shouldShow = true;\n      } else {\n        // Apply selected filters\n        if (isCorrect && filterCorrect?.checked) {\n          shouldShow = true;\n        } else if (!isCorrect && filterIncorrect?.checked) {\n          shouldShow = true;\n        } else if (userAnswer === 'No answer' && filterUnanswered?.checked) {\n          shouldShow = true;\n        }\n      }\n      \n      row.style.display = shouldShow ? '' : 'none';\n    });\n  }\n\n  private clearFilters(): void {\n    const filterCorrect = document.getElementById('filterCorrect') as HTMLInputElement;\n    const filterIncorrect = document.getElementById('filterIncorrect') as HTMLInputElement;\n    const filterUnanswered = document.getElementById('filterUnanswered') as HTMLInputElement;\n\n    if (filterCorrect) filterCorrect.checked = false;\n    if (filterIncorrect) filterIncorrect.checked = false;\n    if (filterUnanswered) filterUnanswered.checked = false;\n\n    this.applyFilters();\n  }\n\n  private startReviewMode(mode: 'all' | 'incorrect' | 'flagged'): void {\n    if (!this.testResult) return;\n\n    this.reviewMode = mode;\n    \n    // Find first question to review based on mode\n    let firstQuestion = 0;\n    \n    if (mode === 'incorrect') {\n      for (let i = 0; i < this.testResult.questions.length; i++) {\n        const userAnswer = this.testResult.answers[i];\n        if (userAnswer && !evaluateAnswer(this.testResult.questions[i], userAnswer)) {\n          firstQuestion = i;\n          break;\n        }\n      }\n    } else if (mode === 'flagged') {\n      for (let i = 0; i < this.testResult.questions.length; i++) {\n        if (this.testResult.flagged.includes(i)) {\n          firstQuestion = i;\n          break;\n        }\n      }\n    }\n\n    this.openReviewModal(firstQuestion);\n  }\n\n  private openReviewModal(questionNum: number): void {\n    if (!this.testResult || questionNum < 0 || questionNum >= this.testResult.questions.length) return;\n\n    this.currentReviewQuestion = questionNum;\n    const question = this.testResult.questions[questionNum];\n    const userAnswer = this.testResult.answers[questionNum] || 'No answer';\n\n    // Update modal title\n    const modalTitle = document.getElementById('reviewQuestionTitle');\n    if (modalTitle) {\n      modalTitle.textContent = `Question ${questionNum + 1} Review`;\n    }\n\n    // Render question using renderer\n    if (questionRenderer) {\n      questionRenderer.renderQuestion(question, {\n        text: '#reviewQuestionText',\n        title: '#reviewQuestionTitle',\n        img: '#reviewQuestionImage',\n        options: '#reviewAnswerOptions',\n        showInput: false, // Don't show input in review mode\n        reviewMode: true,\n        userAnswer: userAnswer\n      });\n    }\n\n\n\n    // Use the unified answer display system for consistent styling\n    if (questionRenderer) {\n      questionRenderer.displayAnswer(question, 'reveal');\n    }\n\n    // Update navigation buttons\n    this.updateReviewNavigation();\n\n    // Show modal\n    const modal = document.getElementById('reviewModal');\n    if (modal) {\n      modal.style.display = 'block';\n    }\n  }\n\n  private closeReviewModal(): void {\n    const modal = document.getElementById('reviewModal');\n    if (modal) {\n      modal.style.display = 'none';\n    }\n  }\n\n  private updateReviewNavigation(): void {\n    if (!this.testResult) return;\n\n    const prevQuestionBtn = document.getElementById('prevQuestionBtn') as HTMLButtonElement;\n    const nextQuestionBtn = document.getElementById('nextQuestionBtn') as HTMLButtonElement;\n\n    if (prevQuestionBtn) {\n      prevQuestionBtn.disabled = this.currentReviewQuestion === 0;\n    }\n    if (nextQuestionBtn) {\n      nextQuestionBtn.disabled = this.currentReviewQuestion === this.testResult.questions.length - 1;\n    }\n  }\n\n  private navigateReviewQuestion(direction: number): void {\n    if (!this.testResult) return;\n\n    let nextQuestion = this.currentReviewQuestion + direction;\n    \n    // Find next question based on mode\n    if (this.reviewMode === 'incorrect') {\n      while (nextQuestion >= 0 && nextQuestion < this.testResult.questions.length) {\n        const userAnswer = this.testResult.answers[nextQuestion];\n        if (userAnswer && !evaluateAnswer(this.testResult.questions[nextQuestion], userAnswer)) {\n          break;\n        }\n        nextQuestion += direction;\n      }\n    } else if (this.reviewMode === 'flagged') {\n      while (nextQuestion >= 0 && nextQuestion < this.testResult.questions.length) {\n        if (this.testResult.flagged.includes(nextQuestion)) {\n          break;\n        }\n        nextQuestion += direction;\n      }\n    }\n\n    // Ensure we stay within bounds\n    if (nextQuestion >= 0 && nextQuestion < this.testResult.questions.length) {\n      this.openReviewModal(nextQuestion);\n    }\n  }\n\n  private setupBackButtonHandling(): void {\n    // Prevent back button navigation\n    window.history.pushState(null, '', window.location.href);\n    \n    window.addEventListener('popstate', () => {\n      // Show confirmation dialog\n      const confirmNavigation = confirm(\n        'Are you sure you want to leave this page? Your test results will be lost.'\n      );\n      \n      if (confirmNavigation) {\n        // User confirmed, navigate to home\n        window.location.href = 'index.html';\n      } else {\n        // User cancelled, prevent navigation and restore state\n        window.history.pushState(null, '', window.location.href);\n      }\n    });\n\n    // Also handle beforeunload for page refresh/close\n    window.addEventListener('beforeunload', (event) => {\n      event.preventDefault();\n      event.returnValue = 'Are you sure you want to leave this page? Your test results will be lost.';\n      return event.returnValue;\n    });\n  }\n}\n\n// SummaryManager is exported and should be instantiated by the page script\n","\n    import { SummaryManager } from '/static/summary.ts';\n    new SummaryManager();\n  "],"names":["window","evaluateAnswer","getCorrectAnswerText","formatExplanation","constructor","__publicField","this","init","setupBackButtonHandling","loadTestResult","setupEventListeners","resultId","URLSearchParams","location","search","get","alert","href","existingHistory","localStorage","getItem","result","JSON","parse","EMPTY_HISTORY","results","find","r","id","testResult","populateSummary","error","console","tbody","document","querySelector","scoreText","getElementById","correctCount","innerHTML","filteredRows","i","questions","length","question","userAnswer","answers","isCorrect","row","insertRow","push","statusClass","statusText","userAnswerText","is_calculation","selectedAnswer","a","answer_number","toString","text","concat","score","Math","round","totalQuestions","textContent","addEventListener","e","btn","target","closest","questionNum","parseInt","dataset","openReviewModal","applyFilters","goHomeBtn","modalClose","closeReviewBtn","prevQuestionBtn","nextQuestionBtn","clearFilterBtn","closeReviewModal","navigateReviewQuestion","clearFilters","filterCorrect","filterIncorrect","filterUnanswered","modal","hasActiveFilters","checked","forEach","index","shouldShow","style","display","startReviewMode","mode","reviewMode","firstQuestion","flagged","includes","currentReviewQuestion","modalTitle","questionRenderer","renderQuestion","title","img","options","showInput","displayAnswer","updateReviewNavigation","disabled","direction","nextQuestion","history","pushState","confirm","event","preventDefault","returnValue"],"mappings":"iVAQCA,OAAeC,eAAiBA,EAChCD,OAAeE,qBAAuBA,EACtCF,OAAeG,kBAAoBA,ECRhC,IDUG,MAML,WAAAC,GALQC,EAAAC,KAAA,aAAoC,MACpCD,EAAAC,KAAA,wBAAgC,GAChCD,EAAAC,KAAA,aAA8C,OAC9CD,EAAAC,KAAA,eAAsC,IAG5CA,KAAKC,OACLD,KAAKE,yBACP,CAEA,IAAAD,GACED,KAAKG,iBACLH,KAAKI,qBACP,CAEQ,cAAAD,GACN,MACME,EADS,IAAIC,gBAAgBZ,OAAOa,SAASC,QAC3BC,IAAI,YAE5B,IAAKJ,EAGH,OAFAK,MAAM,6BACNhB,OAAOa,SAASI,KAAO,cAIzB,IACE,MAAMC,EAAkBC,aAAaC,QAAQ,oBAGvCC,GAFUH,EAAkBI,KAAKC,MAAML,GAAmB,IAAKM,IAE9CC,QAAQC,KAAMC,GAAWA,EAAEC,KAAOjB,GACzD,IAAKU,EAGH,OAFAL,MAAM,8BACNhB,OAAOa,SAASI,KAAO,cAIzBX,KAAKuB,WAAaR,EAClBf,KAAKwB,iBACP,OAASC,GACPC,QAAQD,MAAM,8BAA+BA,GAC7Cf,MAAM,8BACNhB,OAAOa,SAASI,KAAO,YACzB,CACF,CAEQ,eAAAa,GACN,IAAKxB,KAAKuB,WAAY,OAEtB,MAAMI,EAAQC,SAASC,cAAc,wBAC/BC,EAAYF,SAASG,eAAe,aAE1C,IAAKJ,EAAO,OAEZ,IAAIK,EAAe,EACnBL,EAAMM,UAAY,GAClBjC,KAAKkC,aAAe,GAEpB,IAAA,IAASC,EAAI,EAAGA,EAAInC,KAAKuB,WAAWa,UAAUC,OAAQF,IAAK,CACzD,MAAMG,EAAWtC,KAAKuB,WAAWa,UAAUD,GACrCI,EAAavC,KAAKuB,WAAWiB,QAAQL,IAAM,YAC3CM,EACW,cAAfF,GAA8B5C,EAAe2C,EAAUC,GAErDE,GACFT,IAGF,MAAMU,EAAMf,EAAMgB,YAClB3C,KAAKkC,aAAaU,KAAKF,GAEvB,MAAMG,EAAcJ,EAAY,UAAY,YACtCK,EAAaL,EAAY,YAAc,cAG7C,IAAIM,EAAiBR,EACrB,GAAmB,cAAfA,IAA+BD,EAASU,eAAgB,CAC1D,MAAMC,EAAiBX,EAASE,QAAQpB,QAAU8B,EAAEC,cAAcC,aAAeb,GACjFQ,EAAiBE,EAAiBA,EAAeI,KAAOd,CAC1D,CAEAG,EAAIT,UAAY,0DAEmBqB,OAAAnB,EAAI,EAAC,2DAEZmB,OAAAP,EAAc,mDACNO,OAAA1D,EAAqB0C,GAAS,0CACvCgB,OAAAT,EAAW,MAAKS,OAAAR,EAAU,sGAEAQ,OAAAnB,EAAC,2CAGxD,CAEA,MAAMoB,EAAQC,KAAKC,MAAOzB,EAAehC,KAAKuB,WAAWmC,eAAkB,KAGvE5B,IAAWA,EAAU6B,YAAc,cAAcL,OAAAtB,EAAY,KAAIsB,OAAAtD,KAAKuB,WAAWmC,eAAc,MAAKJ,OAAAC,EAAK,OAG7G5B,EAAMiC,iBAAiB,QAAUC,IAC/B,MAAMC,EAAOD,EAAEE,OAAuBC,QAAQ,oBAC9C,GAAIF,EAAK,CACP,MAAMG,EAAcC,SAASJ,EAAIK,QAAQ7B,UAAY,KACrDtC,KAAKoE,gBAAgBH,EACvB,IAIFjE,KAAKqE,cACP,CAEQ,mBAAAjE,GACN,MAAMkE,EAAY1C,SAASG,eAAe,aACpCwC,EAAa3C,SAASC,cAAc,gBACpC2C,EAAiB5C,SAASG,eAAe,kBACzC0C,EAAkB7C,SAASG,eAAe,mBAC1C2C,EAAkB9C,SAASG,eAAe,mBAC1C4C,EAAiB/C,SAASC,cAAc,qBAC1CyC,GACFA,EAAUV,iBAAiB,QAAS,KAClClE,OAAOa,SAASI,KAAO,eAGvB4D,GACFA,EAAWX,iBAAiB,QAAS,IAAM5D,KAAK4E,oBAE9CJ,GACFA,EAAeZ,iBAAiB,QAAS,IAAM5D,KAAK4E,oBAElDH,GACFA,EAAgBb,iBAAiB,QAAS,IAAM5D,KAAK6E,4BAEnDH,GACFA,EAAgBd,iBAAiB,QAAS,IAAM5D,KAAK6E,uBAAuB,IAE1EF,GACFA,EAAef,iBAAiB,QAAS,IAAM5D,KAAK8E,gBAItD,MAAMC,EAAgBnD,SAASG,eAAe,iBACxCiD,EAAkBpD,SAASG,eAAe,mBAC1CkD,EAAmBrD,SAASG,eAAe,oBAE7CgD,GACFA,EAAcnB,iBAAiB,SAAU,IAAM5D,KAAKqE,gBAElDW,GACFA,EAAgBpB,iBAAiB,SAAU,IAAM5D,KAAKqE,gBAEpDY,GACFA,EAAiBrB,iBAAiB,SAAU,IAAM5D,KAAKqE,gBAIzD,MAAMa,EAAQtD,SAASG,eAAe,eAClCmD,GACFA,EAAMtB,iBAAiB,QAAUC,IAC3BA,EAAEE,SAAWmB,GACflF,KAAK4E,oBAIb,CAEQ,YAAAP,GACN,MAAMU,EAAgBnD,SAASG,eAAe,iBACxCiD,EAAkBpD,SAASG,eAAe,mBAC1CkD,EAAmBrD,SAASG,eAAe,oBAEjD,IAAK/B,KAAKuB,WAAY,OAGtB,MAAM4D,GAAoB,MAAAJ,OAAA,EAAAA,EAAeK,WAAW,MAAAJ,OAAA,EAAAA,EAAiBI,WAAW,MAAAH,OAAA,EAAAA,EAAkBG,SAElGpF,KAAKkC,aAAamD,QAAQ,CAAC3C,EAAK4C,KAC9B,MAAMhD,EAAWtC,KAAKuB,WAAYa,UAAUkD,GACtC/C,EAAavC,KAAKuB,WAAYiB,QAAQ8C,IAAU,YAChD7C,EAA2B,cAAfF,GAA8B5C,EAAe2C,EAAUC,GAEzE,IAAIgD,GAAa,EAEZJ,GAKC1C,UAAasC,WAAeK,WAEpB3C,IAAa,MAAAuC,OAAA,EAAAA,EAAiBI,UAEhB,cAAf7C,IAA8B,MAAA0C,OAAA,EAAAA,EAAkBG,YAHzDG,GAAa,GAJfA,GAAa,EAYf7C,EAAI8C,MAAMC,QAAUF,EAAa,GAAK,QAE1C,CAEQ,YAAAT,GACN,MAAMC,EAAgBnD,SAASG,eAAe,iBACxCiD,EAAkBpD,SAASG,eAAe,mBAC1CkD,EAAmBrD,SAASG,eAAe,oBAE7CgD,MAA6BK,SAAU,GACvCJ,MAAiCI,SAAU,GAC3CH,MAAmCG,SAAU,GAEjDpF,KAAKqE,cACP,CAEQ,eAAAqB,CAAgBC,GACtB,IAAK3F,KAAKuB,WAAY,OAEtBvB,KAAK4F,WAAaD,EAGlB,IAAIE,EAAgB,EAEpB,GAAa,cAATF,EACF,IAAA,IAASxD,EAAI,EAAGA,EAAInC,KAAKuB,WAAWa,UAAUC,OAAQF,IAAK,CACzD,MAAMI,EAAavC,KAAKuB,WAAWiB,QAAQL,GAC3C,GAAII,IAAe5C,EAAeK,KAAKuB,WAAWa,UAAUD,GAAII,GAAa,CAC3EsD,EAAgB1D,EAChB,KACF,CACF,MACF,GAAoB,YAATwD,EACT,IAAA,IAASxD,EAAI,EAAGA,EAAInC,KAAKuB,WAAWa,UAAUC,OAAQF,IACpD,GAAInC,KAAKuB,WAAWuE,QAAQC,SAAS5D,GAAI,CACvC0D,EAAgB1D,EAChB,KACF,CAIJnC,KAAKoE,gBAAgByB,EACvB,CAEQ,eAAAzB,CAAgBH,GACtB,IAAKjE,KAAKuB,YAAc0C,EAAc,GAAKA,GAAejE,KAAKuB,WAAWa,UAAUC,OAAQ,OAE5FrC,KAAKgG,sBAAwB/B,EAC7B,MAAM3B,EAAWtC,KAAKuB,WAAWa,UAAU6B,GACrC1B,EAAavC,KAAKuB,WAAWiB,QAAQyB,IAAgB,YAGrDgC,EAAarE,SAASG,eAAe,uBACvCkE,IACFA,EAAWtC,YAAc,YAAYL,OAAAW,EAAc,EAAC,YAIlDiC,GACFA,EAAiBC,eAAe7D,EAAU,CACxCe,KAAM,sBACN+C,MAAO,uBACPC,IAAK,uBACLC,QAAS,uBACTC,WAAW,EACXX,YAAY,EACZrD,eAOA2D,GACFA,EAAiBM,cAAclE,EAAU,UAI3CtC,KAAKyG,yBAGL,MAAMvB,EAAQtD,SAASG,eAAe,eAClCmD,IACFA,EAAMM,MAAMC,QAAU,QAE1B,CAEQ,gBAAAb,GACN,MAAMM,EAAQtD,SAASG,eAAe,eAClCmD,IACFA,EAAMM,MAAMC,QAAU,OAE1B,CAEQ,sBAAAgB,GACN,IAAKzG,KAAKuB,WAAY,OAEtB,MAAMkD,EAAkB7C,SAASG,eAAe,mBAC1C2C,EAAkB9C,SAASG,eAAe,mBAE5C0C,IACFA,EAAgBiC,SAA0C,IAA/B1G,KAAKgG,uBAE9BtB,IACFA,EAAgBgC,SAAW1G,KAAKgG,wBAA0BhG,KAAKuB,WAAWa,UAAUC,OAAS,EAEjG,CAEQ,sBAAAwC,CAAuB8B,GAC7B,IAAK3G,KAAKuB,WAAY,OAEtB,IAAIqF,EAAe5G,KAAKgG,sBAAwBW,EAGhD,GAAwB,cAApB3G,KAAK4F,WACP,KAAOgB,GAAgB,GAAKA,EAAe5G,KAAKuB,WAAWa,UAAUC,QAAQ,CAC3E,MAAME,EAAavC,KAAKuB,WAAWiB,QAAQoE,GAC3C,GAAIrE,IAAe5C,EAAeK,KAAKuB,WAAWa,UAAUwE,GAAerE,GACzE,MAEFqE,GAAgBD,CAClB,MACF,GAA+B,YAApB3G,KAAK4F,WACd,KAAOgB,GAAgB,GAAKA,EAAe5G,KAAKuB,WAAWa,UAAUC,SAC/DrC,KAAKuB,WAAWuE,QAAQC,SAASa,IAGrCA,GAAgBD,EAKhBC,GAAgB,GAAKA,EAAe5G,KAAKuB,WAAWa,UAAUC,QAChErC,KAAKoE,gBAAgBwC,EAEzB,CAEQ,uBAAA1G,GAENR,OAAOmH,QAAQC,UAAU,KAAM,GAAIpH,OAAOa,SAASI,MAEnDjB,OAAOkE,iBAAiB,WAAY,KAERmD,QACxB,6EAKArH,OAAOa,SAASI,KAAO,aAGvBjB,OAAOmH,QAAQC,UAAU,KAAM,GAAIpH,OAAOa,SAASI,QAKvDjB,OAAOkE,iBAAiB,eAAiBoD,IACvCA,EAAMC,iBACND,EAAME,YAAc,4EACbF,EAAME,aAEjB"}