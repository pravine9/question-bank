var e=Object.defineProperty,t=(t,s,n)=>((t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n)(t,"symbol"!=typeof s?s+"":s,n);function s(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import{e as n,g as i,f as o,E as l,q as r}from"./history-Dd79jojy.js";/* empty css                */window.evaluateAnswer=n,window.getCorrectAnswerText=i,window.formatExplanation=o;new class{constructor(){t(this,"testResult",null),t(this,"currentReviewQuestion",0),t(this,"reviewMode","all"),t(this,"filteredRows",[]),this.init(),this.setupBackButtonHandling()}init(){this.loadTestResult(),this.setupEventListeners()}loadTestResult(){const e=new URLSearchParams(window.location.search).get("resultId");if(!e)return alert("No test result found"),void(window.location.href="index.html");try{const t=localStorage.getItem("practice_history"),s=(t?JSON.parse(t):{...l}).results.find(t=>t.id===e);if(!s)return alert("Test result not found"),void(window.location.href="index.html");this.testResult=s,this.populateSummary()}catch(t){console.error("Failed to load test result:",t),alert("Failed to load test result"),window.location.href="index.html"}}populateSummary(){if(!this.testResult)return;const e=document.querySelector(".summary-table tbody"),t=document.getElementById("scoreText");if(!e)return;let s=0;e.innerHTML="",this.filteredRows=[];for(let l=0;l<this.testResult.questions.length;l++){const t=this.testResult.questions[l],o=this.testResult.answers[l]||"No answer",r="No answer"!==o&&n(t,o);r&&s++;const c=e.insertRow();this.filteredRows.push(c);const a=r?"correct":"incorrect",d=r?"✓ Correct":"✗ Incorrect";let u=o;if("No answer"!==o&&!t.is_calculation){const e=t.answers.find(e=>e.answer_number.toString()===o);u=e?e.text:o}c.innerHTML='\n        <td>\n          <div class="question-number">'.concat(l+1,'</div>\n        </td>\n        <td class="answer-cell">').concat(u,'</td>\n        <td class="correct-answer-cell">').concat(i(t),'</td>\n        <td class="status-cell ').concat(a,'">').concat(d,'</td>\n        <td class="review-cell">\n          <button class="review-question" data-question="').concat(l,'">Review</button>\n        </td>\n      ')}const o=Math.round(s/this.testResult.totalQuestions*100);t&&(t.textContent="You scored ".concat(s,"/").concat(this.testResult.totalQuestions," (").concat(o,"%)")),e.addEventListener("click",e=>{const t=e.target.closest(".review-question");if(t){const e=parseInt(t.dataset.question||"0");this.openReviewModal(e)}}),this.applyFilters()}setupEventListeners(){const e=document.getElementById("goHomeBtn"),t=document.querySelector(".modal-close"),s=document.getElementById("closeReviewBtn"),n=document.getElementById("prevQuestionBtn"),i=document.getElementById("nextQuestionBtn"),o=document.querySelector(".clear-filter-btn");e&&e.addEventListener("click",()=>{window.location.href="index.html"}),t&&t.addEventListener("click",()=>this.closeReviewModal()),s&&s.addEventListener("click",()=>this.closeReviewModal()),n&&n.addEventListener("click",()=>this.navigateReviewQuestion(-1)),i&&i.addEventListener("click",()=>this.navigateReviewQuestion(1)),o&&o.addEventListener("click",()=>this.clearFilters());const l=document.getElementById("filterCorrect"),r=document.getElementById("filterIncorrect"),c=document.getElementById("filterUnanswered");l&&l.addEventListener("change",()=>this.applyFilters()),r&&r.addEventListener("change",()=>this.applyFilters()),c&&c.addEventListener("change",()=>this.applyFilters());const a=document.getElementById("reviewModal");a&&a.addEventListener("click",e=>{e.target===a&&this.closeReviewModal()})}applyFilters(){const e=document.getElementById("filterCorrect"),t=document.getElementById("filterIncorrect"),s=document.getElementById("filterUnanswered");if(!this.testResult)return;const i=(null==e?void 0:e.checked)||(null==t?void 0:t.checked)||(null==s?void 0:s.checked);this.filteredRows.forEach((o,l)=>{const r=this.testResult.questions[l],c=this.testResult.answers[l]||"No answer",a="No answer"!==c&&n(r,c);let d=!1;i?(a&&(null==e?void 0:e.checked)||!a&&(null==t?void 0:t.checked)||"No answer"===c&&(null==s?void 0:s.checked))&&(d=!0):d=!0,o.style.display=d?"":"none"})}clearFilters(){const e=document.getElementById("filterCorrect"),t=document.getElementById("filterIncorrect"),s=document.getElementById("filterUnanswered");e&&(e.checked=!1),t&&(t.checked=!1),s&&(s.checked=!1),this.applyFilters()}startReviewMode(e){if(!this.testResult)return;this.reviewMode=e;let t=0;if("incorrect"===e)for(let s=0;s<this.testResult.questions.length;s++){const e=this.testResult.answers[s];if(e&&!n(this.testResult.questions[s],e)){t=s;break}}else if("flagged"===e)for(let s=0;s<this.testResult.questions.length;s++)if(this.testResult.flagged.includes(s)){t=s;break}this.openReviewModal(t)}openReviewModal(e){if(!this.testResult||e<0||e>=this.testResult.questions.length)return;this.currentReviewQuestion=e;const t=this.testResult.questions[e],s=this.testResult.answers[e]||"No answer",n=document.getElementById("reviewQuestionTitle");n&&(n.textContent="Question ".concat(e+1," Review")),r&&r.renderQuestion(t,{text:"#reviewQuestionText",title:"#reviewQuestionTitle",img:"#reviewQuestionImage",options:"#reviewAnswerOptions",showInput:!1,reviewMode:!0,userAnswer:s}),r&&r.displayAnswer(t,"reveal"),this.updateReviewNavigation();const i=document.getElementById("reviewModal");i&&(i.style.display="block")}closeReviewModal(){const e=document.getElementById("reviewModal");e&&(e.style.display="none")}updateReviewNavigation(){if(!this.testResult)return;const e=document.getElementById("prevQuestionBtn"),t=document.getElementById("nextQuestionBtn");e&&(e.disabled=0===this.currentReviewQuestion),t&&(t.disabled=this.currentReviewQuestion===this.testResult.questions.length-1)}navigateReviewQuestion(e){if(!this.testResult)return;let t=this.currentReviewQuestion+e;if("incorrect"===this.reviewMode)for(;t>=0&&t<this.testResult.questions.length;){const s=this.testResult.answers[t];if(s&&!n(this.testResult.questions[t],s))break;t+=e}else if("flagged"===this.reviewMode)for(;t>=0&&t<this.testResult.questions.length&&!this.testResult.flagged.includes(t);)t+=e;t>=0&&t<this.testResult.questions.length&&this.openReviewModal(t)}setupBackButtonHandling(){window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",()=>{confirm("Are you sure you want to leave this page? Your test results will be lost.")?window.location.href="index.html":window.history.pushState(null,"",window.location.href)}),window.addEventListener("beforeunload",e=>(e.preventDefault(),e.returnValue="Are you sure you want to leave this page? Your test results will be lost.",e.returnValue))}};export{s as __vite_legacy_guard};
//# sourceMappingURL=summary-CPAKp5uO.js.map
