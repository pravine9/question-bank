var t=Object.defineProperty,e=(e,s,n)=>((e,s,n)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n)(e,"symbol"!=typeof s?s+"":s,n);function s(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import{e as n,g as i,f as r,q as o,E as a}from"./history-Dd79jojy.js";/* empty css                */import{b as c,f as l}from"./banks-BqbVZJD4.js";function u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var h,d={exports:{}};const m=u((h||(h=1,function(t){function e(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),s.push.apply(s,n)}return s}function s(t){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?e(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,s){return(e=o(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function r(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var n=s.call(t,e);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o(t){var e=r(t,"string");return"symbol"==typeof e?e:String(e)}function a(t,e,s){var n,i="";if((t="number"==typeof t?String(t):t).length>e)return t;for(n=0;n<e;n+=1)i+=String(s);return(i+t).slice(-i.length)}function c(){this.reset()}function l(){this.events={}}c.prototype.toString=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["hours","minutes","seconds"],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;t=t||["hours","minutes","seconds"],e=e||":",s=s||2;var n,i=[];for(n=0;n<t.length;n+=1)void 0!==this[t[n]]&&("secondTenths"===t[n]?i.push(this[t[n]]):i.push(a(this[t[n]],s,"0")));return i.join(e)},c.prototype.reset=function(){this.secondTenths=0,this.seconds=0,this.minutes=0,this.hours=0,this.days=0},l.prototype.on=function(t,e){var s=this;return Array.isArray(this.events[t])||(this.events[t]=[]),this.events[t].push(e),function(){return s.removeListener(t,e)}},l.prototype.removeListener=function(t,e){if(Array.isArray(this.events[t])){var s=this.events[t].indexOf(e);s>-1&&this.events[t].splice(s,1)}},l.prototype.removeAllListeners=function(t){t?Array.isArray(this.events[t])&&(this.events[t]=[]):this.events={}},l.prototype.emit=function(t){for(var e=this,s=arguments.length,n=new Array(s>1?s-1:0),i=1;i<s;i++)n[i-1]=arguments[i];Array.isArray(this.events[t])&&this.events[t].forEach(function(t){return t.apply(e,n)})};var u=10,h=60,d=60,m=24,g=0,p=1,f=2,y=3,v=4,w="secondTenths",b="seconds",S="minutes",T="hours",k="days",x=[w,b,S,T,k],E={secondTenths:100,seconds:1e3,minutes:6e4,hours:36e5,days:864e5},Q={secondTenths:u,seconds:h,minutes:d,hours:m};function C(t,e){return(t%e+e)%e}function L(){var t,e,i,r,o,a,L,q,I,A,O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},j=new c,D=new c,M=new l,P=!1,R=!1,U={},F={detail:{timer:this}};function N(t,e){var s=Q[t];D[t]=e,j[t]=t===k?Math.abs(e):C(e>=0?e:s-C(e,s),s)}function B(t){return z(t,k)}function V(t){return z(t,T)}function H(t){return z(t,S)}function W(t){return z(t,b)}function _(t){return z(t,w)}function z(t,e){var s=D[e];return N(e,ct(t,E[e])),D[e]!==s}function K(){G(),nt()}function G(){clearInterval(t),t=void 0,P=!1,R=!1}function J(t){St()?(I=X(),a=lt(o.target)):it(t),Y()}function Y(){var s=E[e];st(tt(Date.now()))||(t=setInterval(Z,s),P=!0,R=!1)}function X(){return tt(Date.now())-D.secondTenths*E[w]*i}function Z(){var t=tt(Date.now());et($()),r(F.detail.timer),st(t)&&(dt(),wt("targetAchieved",F))}function $(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt(Date.now()),e=i>0?t-I:I-t,s={};return s[w]=_(e),s[b]=W(e),s[S]=H(e),s[T]=V(e),s[k]=B(e),s}function tt(t){return Math.floor(t/E[e])*E[e]}function et(t){t[w]&&wt("secondTenthsUpdated",F),t[b]&&wt("secondsUpdated",F),t[S]&&wt("minutesUpdated",F),t[T]&&wt("hoursUpdated",F),t[k]&&wt("daysUpdated",F)}function st(t){return a instanceof Array&&t>=A}function nt(){j.reset(),D.reset()}function it(t){e=rt((t=t||{}).precision),r="function"==typeof t.callback?t.callback:function(){},q=!0===t.countdown,i=!0===q?-1:1,"object"===n(t.startValues)?ut(t.startValues):L=null,I=X(),$(),"object"===n(t.target)?a=lt(t.target):q?(t.target={seconds:0},a=lt(t.target)):a=null,U={precision:e,callback:r,countdown:"object"===n(t)&&!0===t.countdown,target:a,startValues:L},o=t}function rt(t){if(!ot(t="string"==typeof t?t:b))throw new Error("Error in precision parameter: ".concat(t," is not a valid value"));return t}function ot(t){return x.indexOf(t)>=0}function at(t){var e;if("object"===n(t))if(t instanceof Array){if(5!==t.length)throw new Error("Array size not valid");e=t}else{for(var s in t)if(x.indexOf(s)<0)throw new Error("Error in startValues or target parameter: ".concat(s," is not a valid input value"));e=[t.secondTenths||0,t.seconds||0,t.minutes||0,t.hours||0,t.days||0]}var i=(e=e.map(function(t){return parseInt(t,10)}))[g],r=e[p]+ct(i,u),o=e[f]+ct(r,h),a=e[y]+ct(o,d),c=e[v]+ct(a,m);return e[g]=i%u,e[p]=r%h,e[f]=o%d,e[y]=a%m,e[v]=c,e}function ct(t,e){var s=t/e;return s<0?Math.ceil(s):Math.floor(s)}function lt(t){if(t){var e=ht(a=at(t));return A=I+e.secondTenths*E[w]*i,a}}function ut(t){L=at(t),j.secondTenths=L[g],j.seconds=L[p],j.minutes=L[f],j.hours=L[y],j.days=L[v],D=ht(L,D)}function ht(t,e){var s=e||{};return s.days=t[v],s.hours=s.days*m+t[y],s.minutes=s.hours*d+t[f],s.seconds=s.minutes*h+t[p],s.secondTenths=s.seconds*u+t[[g]],s}function dt(){K(),wt("stopped",F)}function mt(){K(),J(o),wt("reset",F)}function gt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=s(s({},O),t),bt()||(J(t),wt("started",F))}function pt(){G(),R=!0,wt("paused",F)}function ft(t,e){M.on(t,e)}function yt(t,e){M.removeListener(t,e)}function vt(t){M.removeAllListeners(t)}function wt(t,e){M.emit(t,e)}function bt(){return P}function St(){return R}function Tt(){return j}function kt(){return D}function xt(){return U}it(O),void 0!==this&&(this.start=gt,this.pause=pt,this.stop=dt,this.reset=mt,this.isRunning=bt,this.isPaused=St,this.getTimeValues=Tt,this.getTotalTimeValues=kt,this.getConfig=xt,this.addEventListener=ft,this.on=ft,this.removeEventListener=yt,this.removeAllEventListeners=vt,this.off=yt)}t.Timer=L,t.default=L,Object.defineProperty(t,"__esModule",{value:!0})}(d.exports)),d.exports));class g{constructor(t,s={}){e(this,"timer"),e(this,"totalSeconds"),e(this,"callbacks"),e(this,"warningsShown",new Set),e(this,"healthCheckInterval",null),e(this,"lastHealthCheckTime",0),e(this,"healthCheckStallCount",0),this.timer=new m,this.totalSeconds=Math.max(60,3*t*60),this.callbacks=s,this.setupEventListeners(),this.setupTimerHealthCheck()}setupEventListeners(){this.timer.addEventListener("secondsUpdated",()=>{const t=this.timer.getTimeValues(),e=this.timer.getTotalTimeValues().seconds;this.callbacks.onUpdate&&this.callbacks.onUpdate(t),this.checkWarnings(e)}),this.timer.addEventListener("targetAchieved",()=>{this.callbacks.onComplete&&this.callbacks.onComplete()})}checkWarnings(t){const e=300;t!==e||this.warningsShown.has(e)||(this.warningsShown.add(e),this.callbacks.onWarning&&this.callbacks.onWarning({timeLeft:e,message:"⚠️ 5 minutes remaining"})),60!==t||this.warningsShown.has(60)||(this.warningsShown.add(60),this.callbacks.onWarning&&this.callbacks.onWarning({timeLeft:60,message:"⚠️ 1 minute remaining"}))}start(){this.startWithTime(this.totalSeconds)}startWithTime(t){try{this.timer.start({countdown:!0,startValues:{seconds:t}})}catch(e){console.error("Failed to start timer:",e),setTimeout(()=>{try{this.timer.start({countdown:!0,startValues:{seconds:t}})}catch(e){console.error("Timer restart failed:",e)}},100)}}setupTimerHealthCheck(){this.healthCheckInterval=window.setInterval(()=>{if(this.timer.isRunning()){const t=this.getTotalRemainingSeconds();t<=0&&(console.warn("Timer health check: Timer expired, triggering completion"),this.clearHealthCheck(),this.callbacks.onComplete&&this.callbacks.onComplete()),this.checkTimerStall(t)}},3e4)}checkTimerStall(t){if(this.lastHealthCheckTime===t){if(this.healthCheckStallCount++,this.healthCheckStallCount>=3){console.warn("Timer appears stalled, attempting restart"),this.healthCheckStallCount=0;this.timer.isRunning()&&(this.timer.stop(),this.timer.start({countdown:!0,startValues:{seconds:t}}))}}else this.healthCheckStallCount=0;this.lastHealthCheckTime=t}clearHealthCheck(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}pause(){this.timer.pause()}resume(){this.timer.isPaused()&&this.timer.start()}stop(){this.timer.stop()}reset(){this.timer.reset(),this.warningsShown.clear()}getRemainingTime(){return this.timer.getTimeValues()}getTotalRemainingSeconds(){return this.timer.getTotalTimeValues().seconds}getFormattedTime(){const t=this.timer.getTimeValues(),e=t.hours.toString().padStart(2,"0"),s=t.minutes.toString().padStart(2,"0"),n=t.seconds.toString().padStart(2,"0");return t.hours>0?"".concat(e,":").concat(s,":").concat(n):"".concat(s,":").concat(n)}isRunning(){return this.timer.isRunning()}isPaused(){return this.timer.isPaused()}destroy(){this.clearHealthCheck(),this.timer.removeAllEventListeners(),this.timer.stop()}static formatSeconds(t){const e=Math.floor(t/3600),s=Math.floor(t%3600/60),n=t%60;return e>0?"".concat(e.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")):"".concat(s.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))}static calculateTestDuration(t){return 3*t*60}}window.evaluateAnswer=n,window.getCorrectAnswerText=i,window.formatExplanation=r;(new class{constructor(){e(this,"state",null),e(this,"isFinished",!1),e(this,"sessionKey",""),e(this,"timer",null),e(this,"timerDisplayElement",null),e(this,"timeUpTriggered",!1),this.timerDisplayElement=document.getElementById("timerValue")}init(){const t=new URLSearchParams(window.location.search),e=t.get("bank"),s=parseInt(t.get("num")||"10"),n="true"===t.get("resume");if(!e||!c||!c[e])return alert("No valid question bank selected"),void(window.location.href="index.html");this.sessionKey="practice_session_".concat(e,"_").concat(s),n||this.loadExistingSession()?console.log("Resuming existing practice session"):this.setupPracticeSession(e,s),this.setupEventListeners(),this.renderCurrentQuestion(),window.addEventListener("beforeunload",()=>{this.saveSession(),this.timer&&this.timer.destroy()})}setupPracticeSession(t,e){const s=c[t];if(!s||!s.length)return void alert("Question bank is empty");(e<=0||e>100)&&(alert("Invalid number of questions. Using default of 10."),e=10);const n=[];s.forEach(t=>{n.push(...t)});const i=n.sort(()=>Math.random()-.5),r=i.slice(0,Math.min(e,i.length));this.state={currentQuestion:0,questions:r,answers:{},flagged:new Set,startTime:Date.now(),bank:t,totalQuestions:r.length};const o=document.querySelector(".test-title");o&&(o.textContent="".concat(l(t)," - ").concat(r.length," Questions")),this.setupNavigation(),this.updateProgress(),this.initializeTimer()}setupNavigation(){if(!this.state)return;const t=document.querySelector(".sidebar .nav");if(t){t.innerHTML="";for(let e=0;e<this.state.totalQuestions;e++){const s=document.createElement("li");s.dataset.question=e.toString(),s.textContent=(e+1).toString(),t.appendChild(s)}t.addEventListener("click",t=>{const e=t.target.closest("li");if(e&&e.dataset.question){const t=parseInt(e.dataset.question);this.goToQuestion(t)}})}}setupEventListeners(){const t=document.querySelector(".back-btn"),e=document.querySelector(".next-btn"),s=document.querySelector(".flag-current-btn"),n=document.querySelector(".finish-btn"),i=document.getElementById("checkBtn");t&&t.addEventListener("click",()=>this.previousQuestion()),e&&e.addEventListener("click",()=>this.nextQuestion()),s&&s.addEventListener("click",()=>this.toggleFlag()),n&&n.addEventListener("click",()=>this.finishTest()),i&&i.addEventListener("click",()=>this.toggleCheck()),document.addEventListener("change",t=>{const e=t.target;"answer"!==e.name&&"calcInput"!==e.id||this.saveAnswer()});const r=document.querySelector(".review-status-btn");r&&r.addEventListener("click",()=>this.showReviewModal());const o=document.querySelector(".modal-close");o&&o.addEventListener("click",()=>this.hideReviewModal())}renderCurrentQuestion(){if(!this.state||this.state.currentQuestion>=this.state.questions.length)return;const t=this.state.questions[this.state.currentQuestion],e=document.querySelector(".q-number");e&&(e.textContent="Question ".concat(this.state.currentQuestion+1)),o&&o.renderQuestion(t,{text:"#qText",title:"#qTitle",img:"#qImg",options:"#answerOptions",input:".calculator",unit:"#answerUnit",feedback:"#feedback",answer:"#answer",explanation:"#explanation"});const s=this.state.answers[this.state.currentQuestion];if(s)if(t.is_calculation){const t=document.getElementById("calcInput");t&&(t.value=s)}else{const t=document.querySelector('input[name="answer"][value="'.concat(s,'"]'));if(t){t.checked=!0;const e=t.closest("label");e&&e.classList.add("selected")}}const n=document.getElementById("questionFlag");n&&(this.state.flagged.has(this.state.currentQuestion)?n.style.display="inline":n.style.display="none"),this.resetFeedbackAndButtons(),this.updateNavigation(),this.updateProgress(),this.saveSession()}saveAnswer(){if(!this.state)return;let t="";if(this.state.questions[this.state.currentQuestion].is_calculation){const e=document.getElementById("calcInput");t=(null==e?void 0:e.value)||""}else{const e=document.querySelector('input[name="answer"]:checked');t=(null==e?void 0:e.value)||""}if(t?(this.state.answers[this.state.currentQuestion]=t,this.updateNavigation(),this.updateProgress(),this.saveSession()):(delete this.state.answers[this.state.currentQuestion],this.updateNavigation(),this.updateProgress(),this.saveSession()),o){if("hidden"!==o.getCurrentDisplayState()){const t=this.state.questions[this.state.currentQuestion];o.displayAnswer(t,"hide")}}}updateProgress(){if(!this.state)return;const t=document.querySelector(".progress .bar"),e=Object.keys(this.state.answers).length/this.state.totalQuestions*100;t&&(t.style.width="".concat(e,"%"))}updateNavigation(){if(!this.state)return;const t=document.querySelector(".back-btn"),e=document.querySelector(".next-btn"),s=document.querySelector(".flag-current-btn");t&&(t.disabled=0===this.state.currentQuestion),e&&(e.disabled=this.state.currentQuestion===this.state.totalQuestions-1),s&&s.classList.toggle("active",this.state.flagged.has(this.state.currentQuestion));document.querySelectorAll(".sidebar .nav li").forEach((t,e)=>{const s=t;s.classList.remove("active","answered","flagged");const n=e+1;this.state.flagged.has(e)?(s.innerHTML="".concat(n,' <span class="flag-btn">⚑</span>'),s.classList.add("flagged")):s.textContent=n.toString(),e===this.state.currentQuestion&&s.classList.add("active"),this.state.answers[e]&&s.classList.add("answered")})}goToQuestion(t){!this.state||t<0||t>=this.state.totalQuestions||(this.state.currentQuestion=t,this.renderCurrentQuestion())}previousQuestion(){!this.state||this.state.currentQuestion<=0||this.goToQuestion(this.state.currentQuestion-1)}nextQuestion(){!this.state||this.state.currentQuestion>=this.state.totalQuestions-1||this.goToQuestion(this.state.currentQuestion+1)}toggleFlag(){if(!this.state)return;const t=this.state.currentQuestion,e=document.getElementById("questionFlag");this.state.flagged.has(t)?(this.state.flagged.delete(t),e&&(e.style.display="none")):(this.state.flagged.add(t),e&&(e.style.display="inline")),this.updateNavigation(),this.saveSession()}toggleCheck(){if(!this.state||!o)return;const t=this.state.questions[this.state.currentQuestion],e=this.state.answers[this.state.currentQuestion];"checked"===o.getCurrentDisplayState()?o.displayAnswer(t,"hide"):o.displayAnswer(t,"check",e)}resetFeedbackAndButtons(){if(!o)return;o.displayAnswer({id:0},"hide")}finishTest(){if(!this.state)return;const t=Object.keys(this.state.answers).length,e=this.state.totalQuestions-t;if(e>0){if(!window.confirm("You have ".concat(e," unanswered questions. Are you sure you want to finish the test?")))return}this.calculateResults(),this.clearSession(),this.showSummary()}initializeTimer(t){if(this.state){if(this.timer&&(this.timer.destroy(),this.timer=null),this.timer=new g(this.state.totalQuestions,{onUpdate:()=>this.updateTimerDisplay(),onWarning:t=>this.handleTimerWarning(t),onComplete:()=>this.handleTimeUp()}),void 0!==t&&t>0){const e=3*this.state.totalQuestions*60-t;this.state.startTime=Date.now()-1e3*e,this.timer.startWithTime(t)}else this.timer.start();this.checkTimerExpiry()}}checkTimerExpiry(){if(!this.state||!this.timer)return;Date.now()-this.state.startTime>=3*this.state.totalQuestions*60*1e3&&(console.warn("Timer failsafe triggered - test time has expired"),this.handleTimeUp())}updateTimerDisplay(){if(this.timerDisplayElement&&this.timer)try{const t=this.timer.getFormattedTime();this.timerDisplayElement.textContent=t;const e=this.timer.getTotalRemainingSeconds(),s=document.getElementById("timerDisplay");if(e<0)return console.warn("Timer display failsafe: Negative time detected, triggering completion"),void this.handleTimeUp();s&&(s.classList.remove("warning","critical"),e<=60?s.classList.add("critical"):e<=300&&s.classList.add("warning"))}catch(t){console.error("Error updating timer display:",t),this.timerDisplayElement&&(this.timerDisplayElement.textContent="00:00")}}handleTimerWarning(t){!function(t){const e=document.createElement("div");e.className="timer-warning",e.textContent=t.message,e.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #ff9800;\n    color: white;\n    padding: 12px 20px;\n    border-radius: 6px;\n    font-weight: 600;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    z-index: 1000;\n    animation: slideInRight 0.3s ease-out;\n  ";const s=document.createElement("style");s.textContent="\n    @keyframes slideInRight {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n    @keyframes fadeOut {\n      from {\n        opacity: 1;\n      }\n      to {\n        opacity: 0;\n      }\n    }\n  ",document.head.appendChild(s),document.body.appendChild(e),setTimeout(()=>{e.style.animation="fadeOut 0.3s ease-out",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)},5e3)}(t)}handleTimeUp(){if(!this.state||this.timeUpTriggered)return;this.timeUpTriggered=!0,this.isFinished=!0,this.timer&&(this.timer.destroy(),this.timer=null);const t=this.createTimeUpModal();document.body.appendChild(t)}createTimeUpModal(){const t=document.createElement("div");t.className="time-up-modal",t.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      font-family: 'Nunito', sans-serif;\n    ";const e=document.createElement("div");e.style.cssText="\n      background: white;\n      padding: 40px;\n      border-radius: 12px;\n      text-align: center;\n      max-width: 400px;\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n    ";const s=document.createElement("h2");s.textContent="⏰ Time's Up!",s.style.cssText="\n      color: #e74c3c;\n      margin: 0 0 20px 0;\n      font-size: 28px;\n    ";const n=document.createElement("p");n.textContent="Your practice test time has expired. You can still review your answers or finish the test now.",n.style.cssText="\n      color: #555;\n      margin: 0 0 30px 0;\n      line-height: 1.5;\n      font-size: 16px;\n    ";const i=document.createElement("div");i.style.cssText="\n      display: flex;\n      gap: 15px;\n      justify-content: center;\n    ";const r=document.createElement("button");r.textContent="Finish Test",r.className="btn btn-danger",r.style.cssText="\n      padding: 12px 24px;\n      font-weight: 600;\n      border: none;\n      border-radius: 6px;\n      cursor: pointer;\n      background: #e74c3c;\n      color: white;\n    ",r.addEventListener("click",()=>{document.body.removeChild(t),this.finishTest()});const o=document.createElement("button");return o.textContent="Continue Review",o.className="btn btn-secondary",o.style.cssText="\n      padding: 12px 24px;\n      font-weight: 600;\n      border: 1px solid #ccc;\n      border-radius: 6px;\n      cursor: pointer;\n      background: white;\n      color: #555;\n    ",o.addEventListener("click",()=>{document.body.removeChild(t)}),i.appendChild(r),i.appendChild(o),e.appendChild(s),e.appendChild(n),e.appendChild(i),t.appendChild(e),t}calculateResults(){if(!this.state)return;let t=0;const e=Math.floor((Date.now()-this.state.startTime)/6e4);for(let r=0;r<this.state.questions.length;r++){const e=this.state.questions[r],s=this.state.answers[r];s&&n(e,s)&&t++}const s=Math.round(t/this.state.totalQuestions*100),i=Date.now().toString();this.savePracticeResult({id:i,bank:this.state.bank,totalQuestions:this.state.totalQuestions,correctAnswers:t,score:s,duration:e,date:(new Date).toISOString(),flaggedQuestions:this.state.flagged.size,questions:this.state.questions,answers:this.state.answers,flagged:Array.from(this.state.flagged)}),this.isFinished=!0,window.location.href="summary.html?resultId=".concat(i)}showSummary(){}showReviewModal(){if(!this.state)return;const t=document.getElementById("reviewModal");t&&(this.setupFilterHandlers(),this.updateQuestionGrid(),t.style.display="block")}setupFilterHandlers(){const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),s=document.getElementById("filterFlagged"),n=document.querySelector(".clear-filter-btn");t&&t.addEventListener("change",()=>this.updateQuestionGrid()),e&&e.addEventListener("change",()=>this.updateQuestionGrid()),s&&s.addEventListener("change",()=>this.updateQuestionGrid()),n&&n.addEventListener("click",()=>this.clearFilters())}clearFilters(){const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),s=document.getElementById("filterFlagged");t&&(t.checked=!1),e&&(e.checked=!1),s&&(s.checked=!1),this.updateQuestionGrid()}updateQuestionGrid(){if(!this.state)return;const t=document.getElementById("filterUnattempted"),e=document.getElementById("filterAttempted"),s=document.getElementById("filterFlagged"),n=document.getElementById("questionGridReview");if(n){n.innerHTML="";for(let i=0;i<this.state.totalQuestions;i++){const r=!!this.state.answers[i],o=this.state.flagged.has(i),a=i===this.state.currentQuestion;let c=!1;if((null==t?void 0:t.checked)||(null==e?void 0:e.checked)||(null==s?void 0:s.checked)?(r&&(null==e?void 0:e.checked)&&(c=!0),!r&&(null==t?void 0:t.checked)&&(c=!0),o&&(null==s?void 0:s.checked)&&(c=!0)):c=!0,!c)continue;const l=document.createElement("button");l.className="grid-item",l.dataset.question=i.toString();const u=i+1;o?(l.innerHTML="".concat(u,' <span class="flag-btn">⚑</span>'),l.classList.add("flagged")):l.textContent=u.toString(),r&&l.classList.add("answered"),a&&l.classList.add("active"),l.addEventListener("click",()=>{this.goToQuestion(i),this.hideReviewModal()}),n.appendChild(l)}}}hideReviewModal(){const t=document.getElementById("reviewModal");t&&(t.style.display="none")}savePracticeResult(t){try{const e=localStorage.getItem("practice_history"),s=e?JSON.parse(e):{...a};s.results.unshift(t),s.results.length>50&&(s.results=s.results.slice(0,50)),localStorage.setItem("practice_history",JSON.stringify(s))}catch(e){console.warn("Failed to save practice result:",e)}}saveSession(){if(this.state&&!this.isFinished)try{let t=0;if(this.timer&&this.timer.isRunning())t=this.timer.getTotalRemainingSeconds();else{const e=Date.now()-this.state.startTime,s=3*this.state.totalQuestions*60*1e3;t=Math.max(0,Math.floor((s-e)/1e3))}const e={currentQuestion:this.state.currentQuestion,answers:this.state.answers,flagged:Array.from(this.state.flagged),startTime:this.state.startTime,bank:this.state.bank,totalQuestions:this.state.totalQuestions,questions:this.state.questions.map(t=>t.id),timestamp:Date.now(),remainingSeconds:t,timerActive:!this.timer||this.timer.isRunning()};sessionStorage.setItem(this.sessionKey,JSON.stringify(e)),console.log("Session saved:",this.sessionKey)}catch(t){console.warn("Failed to save session:",t)}}loadExistingSession(){try{const t=sessionStorage.getItem(this.sessionKey);if(!t)return!1;const e=JSON.parse(t);if(Date.now()-e.timestamp>864e5)return sessionStorage.removeItem(this.sessionKey),!1;const s=c[e.bank],n=[];s.forEach(t=>{n.push(...t)});const i=e.questions.map(t=>n.find(e=>e.id===t)).filter(t=>void 0!==t);if(i.length!==e.totalQuestions)return console.warn("Question mismatch, starting new session"),!1;this.state={currentQuestion:e.currentQuestion,questions:i,answers:e.answers||{},flagged:new Set(e.flagged||[]),startTime:e.startTime,bank:e.bank,totalQuestions:e.totalQuestions};const r=document.querySelector(".test-title");r&&(r.textContent="".concat(l(e.bank)," - ").concat(i.length," Questions")),this.setupNavigation();const o=e.remainingSeconds;return!1!==e.timerActive&&o>0?this.initializeTimer(o):o<=0?this.handleTimeUp():this.initializeTimer(),console.log("Session loaded successfully"),!0}catch(t){return console.warn("Failed to load session:",t),!1}}clearSession(){try{sessionStorage.removeItem(this.sessionKey),console.log("Session cleared:",this.sessionKey)}catch(t){console.warn("Failed to clear session:",t)}this.timer&&(this.timer.destroy(),this.timer=null)}}).init();export{s as __vite_legacy_guard};
//# sourceMappingURL=practice-2sBlZE1S.js.map
